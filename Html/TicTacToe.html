<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tic Tac Toe</title>

    <script src="https://kit.fontawesome.com/4b5542137e.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../css/bootstrap.css">
    <link rel="stylesheet" href="../hCss/ttt.css">
</head>
<body>

<br>
<!--back arrow to index page-->
<a class="l-arrow btn btn-dark" href="../index.html">
    <i class="fa fa-arrow-left"></i>
</a>
<div id="title">
    <h1>Tic Tac Toe</h1>
</div>

<div id="whoseTurn">

</div>
<br>
<div class="ticTacToe-board-2" id="t-board">
    <br>
    <table class="tb-table">
        <tr class="row-1">
            <td id="b0" class="tb" onclick="checkPlayerTurn()"></td>
            <td id="b1" class="tb" onclick="checkPlayerTurn()"></td>
            <td id="b2" class="tb" onclick="checkPlayerTurn()"></td>
        </tr>

        <tr class="row-2">
            <td id="b3" class="tb" onclick="checkPlayerTurn()"></td>
            <td id="b4" class="tb" onclick="checkPlayerTurn()"></td>
            <td id="b5" class="tb" onclick="checkPlayerTurn()"></td>
        </tr>
        <tr class="row3">
            <td id="b6" class="tb" onclick="checkPlayerTurn()"></td>
            <td id="b7" class="tb" onclick="checkPlayerTurn()"></td>
            <td id="b8" class="tb" onclick="checkPlayerTurn()"></td>
        <tr>
    </table>
</div>

<!--<br>
<br>
<br>
<hr>
<div class="ticTacToe-board">
    <div id="board_0" class="t-board"></div>
    <div id="board_1" class="t-board"></div>
    <div id="board_2" class="t-board"></div>
    <div id="board_3" class="t-board"></div>
    <div id="board_4" class="t-board"></div>
    <div id="board_5" class="t-board"></div>
    <div id="board_6" class="t-board"></div>
    <div id="board_7" class="t-board"></div>
    <div id="board_8" class="t-board"></div>
</div>-->

<a class="btn btn-outline-dark" onclick="startGame()">Start Game</a>
<a class="btn btn-outline-dark" onclick="reset()">Reset</a>


<script>
    //used to identify the turn of the human player
    let person = 0;
    //used to identify the turn of the computer player
    let comp = 0;
    //used to identify whether start game was pressed
    let pressed = 0;

    let currentTurn = 1;

    //function to start the tic tac toe game
    function startGame() {
        if (pressed !== 1) {
            pressed = 1;
            let range = Math.floor(Math.random() * (10 - 1) + 1);

            if (document.getElementById("title").innerHTML.indexOf("<h3>You are Player 2</h3>") !== -1
                || document.getElementById("title").innerHTML.indexOf("<h3>You are Player 1</h3>") !== -1) {
                document.getElementById("title").innerHTML = "<h1>Tic Tac Toe</h1>"
            }

            if (range % 2 === 0) {
                document.getElementById("title").innerHTML += "<h3>You are Player 2</h3>";
                document.getElementById("whoseTurn").innerHTML = "<h2>Enemy Turn</h2>";
                person = 2;
                comp = 1;
                compTurn(comp);
            } else {
                document.getElementById("title").innerHTML += "<h3>You are Player 1</h3>";
                document.getElementById("whoseTurn").innerHTML = "<h2>Your Turn</h2>";
                person = 1;
                comp = 2;
                personTurn(person);
            }
        }
    }

    function checkPlayerTurn() {
        if (currentTurn === person) {
            personTurn(person);
        }
    }

    function personTurn(sym) {
        document.getElementById("t-board").style.cursor = "pointer";
        document.getElementById("whoseTurn").innerHTML = "<h2>Your Turn</h2>";
        let board = Math.floor(Math.random() * 9);
        let letter;
        let op;
        let comp;

        if (sym === 1) {
            comp = 2;
        } else {
            comp = 1;
        }

        if (sym === 1) {
            letter = "X";
            op = "O"
        } else {
            letter = "O";
            op = "O";
        }

        if (document.getElementById("b" + board).innerText === "") {
            //document.getElementById("b" + board).textContent = letter;
            currentTurn = comp;
            document.getElementById("t-board").style.cursor = "";
            //compTurn(comp);
        } else {
            checkEnd();
            personTurn(sym);
        }
        checkEnd();
    }

    function compTurn(sym) {
        document.getElementById("whoseTurn").innerHTML += "<h2>Enemy Turn</h2>";
        let board = Math.floor(Math.random() * 9);
        let letter;
        let op;
        let helpPerson;

        if (sym === 1) {
            helpPerson = 2;
        } else {
            helpPerson = 1;
        }

        if (sym === 1) {
            letter = "X";
            op = "O"
        } else {
            letter = "O";
            op = "O";
        }

        if (document.getElementById("b" + board).innerText === "") {
            document.getElementById("b" + board).textContent = letter;
            currentTurn = helpPerson;
            checkPlayerTurn();
        } else {
            checkEnd();
            compTurn(sym);
        }
        checkEnd();
    }

    function checkEnd() {
        console.log("check end");

        let boards = document.getElementsByClassName("tb");
        let currFilled = 0;
        for (let i = 0; i < boards.length; i++) {
            console.log("1");
            if (boards[i].innerText !== "") {
                currFilled += 1;
            }
        }
        document.getElementById("title").innerHTML += "Curr Filled" + currFilled;

        if (currFilled === 9) {
            document.getElementById("t-board").innerText = "GAME OVER!"
        }
    }

    function reset() {
        pressed = 0;
        if (document.getElementById("title").innerHTML.indexOf("<h3>You are Player 2</h3>") !== -1
            || document.getElementById("title").innerHTML.indexOf("<h3>You are Player 1</h3>") !== -1) {
            document.getElementById("title").innerHTML = "<h1>Tic Tac Toe</h1>"
        }

        document.getElementById("whoseTurn").innerHTML = "";
        document.getElementById("t-board").innerHTML = "<br>\n" +
            "    <table class=\"tb-table\">\n" +
            "        <tr class=\"row-1\">\n" +
            "            <td id=\"b0\" class=\"tb\" onclick=\"turnGreen('b0')\"></td>\n" +
            "            <td id=\"b1\" class=\"tb\" onclick=\"turnGreen('b1')\"></td>\n" +
            "            <td id=\"b2\" class=\"tb\"></td>\n" +
            "        </tr>\n" +
            "\n" +
            "        <tr class=\"row-2\">\n" +
            "            <td id=\"b3\" class=\"tb\"></td>\n" +
            "            <td id=\"b4\" class=\"tb\"></td>\n" +
            "            <td id=\"b5\" class=\"tb\"></td>\n" +
            "        </tr>\n" +
            "        <tr class=\"row3\">\n" +
            "            <td id=\"b6\" class=\"tb\"></td>\n" +
            "            <td id=\"b7\" class=\"tb\"></td>\n" +
            "            <td id=\"b8\" class=\"tb\"></td>\n" +
            "        <tr>"
    }
</script>

</body>
</html>